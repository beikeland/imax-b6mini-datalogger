# imax-b6mini-datalogger
Script for dumping data from IMAX B6 mini charger into `csv` format.

Usage: pipe stdout into file, if necessary run from root. Query interval and device VID/PID can be modified in script.

Requires https://pypi.python.org/pypi/hidapi/

Not tested with Windows, but it should work.

Forking to use with B6AC v2 (pr comments by alexwlpr) and adding ability to control charge/discharge/storage cycle. F.ex. charge and discharge 3 cycles and then apply storage charge.

Current progress of protocol decoding
Storage charge 1S 2.0a charge 2.0a discharge. Packet needs 0x00 at the start to work when sent with h.write()
```
0f:16:05:00:01:01:02:07:d0:07:d0:0c:1c:10:04:00:00:00:00:00:00:00:00:f3:ff:ff + :00 * 38
              |  |  |     |                                         |xx?? checksom
              |  |  |     |xx:xx discharge current
              |  |  |xx:xx charge current 
              |  |xx 00=charge, 01=discharge, 02=storage
              |xx = # cells 01..06.    
```

```
#data strings
padding	=[0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
#1S 1A discharge
discharge=[0x0f, 0x16, 0x05, 0x00, 0x01, 0x01, 0x01, 0x03, 0xe8, 0x03, 0xe8, 0x0c, 0x1c, 0x10, 0x68, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7e, 0xff, 0xff]
#1S 1A discharge
charge	 =[0x0f, 0x16, 0x05, 0x00, 0x01, 0x01, 0x00, 0x03, 0xe8, 0x00, 0x64, 0x0c, 0x1c, 0x10, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x92, 0xff, 0xff]
#1S 2A storage charge
storage	=[0x0f, 0x16, 0x05, 0x00, 0x01, 0x01, 0x02, 0x07, 0xd0, 0x03, 0xe8, 0x0c, 0x1c, 0x10, 0x68, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x6b, 0xff, 0xff]
#generic polling command
poll		 =[0x0F, 0x03, 0x55, 0x00, 0x55, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]

h.write([0x00] + charge + padding)
sleep(1)
print(".")
h.write([0x00] + poll + padding)
data = h.read(64, 1000)
```
